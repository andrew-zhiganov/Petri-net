<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <title>Сети Петри</title>

    <link href="interactive_tree.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="d3.v2.js"></script>
    <script type="text/javascript" src="jquery-2.2.4.min.js"></script>
    <script type="text/javascript" src="interactive_tree.js"></script>
    <script type="text/javascript" src="generate_tree.js"></script>
</head>
<body>
    <table>
        <tr>
            <td>
                <svg width="500" height="400">
                    <marker id="triangle" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="strokeWidth" markerWidth="5" markerHeight="5" orient="auto">
                    <path d="M 0 0 L 10 5 L 0 10 z"/>
                    </marker>
                    <circle id="p1" cx="240" cy="40" r="25" stroke="black" stroke-width="1" fill="white"/>
                    <circle id="p2" cx="120" cy="120" r="25" stroke="black" stroke-width="1" fill="white"/>
                    <circle id="p3" cx="360" cy="120" r="25" stroke="black" stroke-width="1" fill="white"/>
                    <circle id="p4" cx="120" cy="240" r="25" stroke="black" stroke-width="1" fill="white"/>
                    <circle id="p5" cx="360" cy="240" r="25" stroke="black" stroke-width="1" fill="white"/>
                    <rect id="t1" x="155" y="75" width="50" height="4" fill="black"/>
                    <rect id="t2" x="275" y="75" width="50" height="4" fill="black"/>
                    <rect id="t3" x="95" y="175" width="50" height="4" fill="black"/>
                    <rect id="t4" x="335" y="175" width="50" height="4" fill="black"/>
                    <rect id="t5" x="215" y="320" width="50" height="4" fill="black"/>
                    <rect id="t6" x="420" y="120" width="50" height="4" fill="black"/>
                    <line x1="216" y1="51" x2="190" y2="70" stroke="black" stroke-width="2" marker-end="url(#triangle)"/>
                    <line x1="185" y1="74" x2="150" y2="101" stroke="black" stroke-width="2" marker-end="url(#triangle)"/>
                    <line x1="120" y1="145" x2="120" y2="168" stroke="black" stroke-width="2" marker-end="url(#triangle)"/>
                    <line x1="120" y1="179" x2="120" y2="207" stroke="black" stroke-width="2" marker-end="url(#triangle)"/>
                    <line x1="120" y1="265" x2="228" y2="316" stroke="black" stroke-width="2" marker-end="url(#triangle)"/>
                    <line x1="264" y1="51" x2="290" y2="70" stroke="black" stroke-width="2" marker-end="url(#triangle)"/>
                    <line x1="295" y1="74" x2="330" y2="101" stroke="black" stroke-width="2" marker-end="url(#triangle)"/>
                    <line x1="360" y1="145" x2="360" y2="168" stroke="black" stroke-width="2" marker-end="url(#triangle)"/>
                    <line x1="360" y1="179" x2="360" y2="207" stroke="black" stroke-width="2" marker-end="url(#triangle)"/>
                    <line x1="360" y1="265" x2="252" y2="316" stroke="black" stroke-width="2" marker-end="url(#triangle)"/>
                    <path d="M242 324 L242 350 L80 350 L80 40 L207 40" stroke="black" stroke-width="2" fill="none" marker-end="url(#triangle)"/>
                    <path d="M379 105 L440 105 L440 110" stroke="black" stroke-width="2" fill="none" marker-end="url(#triangle)"/>
                    <path d="M440 115 L440 135 L388 135" stroke="black" stroke-width="2" fill="none" marker-end="url(#triangle)"/>
                    <path d="M455 121 L455 244 L393 244" stroke="black" stroke-width="2" fill="none" marker-end="url(#triangle)"/>
                </svg>
            </td>
            <td>
                <svg width="20px" height="200">
                    <text x="0" y="67" size="12">P1</text>
                    <text x="0" y="92" size="12">P2</text>
                    <text x="0" y="117" size="12">P3</text>
                    <text x="0" y="142" size="12">P4</text>
                    <text x="0" y="167" size="12">P5</text>
                </svg>
            </td>
            <td>
                <div style="text-align: center; font-family: 'Comic Sans MS';">Введите начальную<br>маркировку</div>
                <table style="margin-left: 0px">
                    <tr><td><input id="p1" type="number" placeholder="P1"></td></tr>
                    <tr><td><input id="p2" type="number" placeholder="P2"></td></tr>
                    <tr><td><input id="p3" type="number" placeholder="P3"></td></tr>
                    <tr><td><input id="p4" type="number" placeholder="P4"></td></tr>
                    <tr><td><input id="p5" type="number" placeholder="P5"></td></tr>
                </table>
                <div style="text-align: center;">
                    <input style="font-family: 'Comic Sans MS';" type="button" id="genTree" onclick="makeStartMark();" value="Построить дерево" />
                </div>
            </td>
            <td id="append"></td>
        </tr>
    </table>
    <div id="chart"></div>
</body>
<script type="text/javascript">
    function makeStartMark(){
        var startMark = [];
        if(Number($('input#p1').val()) && $('input#p1').val() >= 0){
            startMark.push(Number($('input#p1').val()));
        }
        else{
            startMark.push(0);
        }
        if(Number($('input#p2').val()) && $('input#p2').val() >= 0){
            startMark.push(Number($('input#p2').val()));
        }
        else{
            startMark.push(0);
        }if(Number($('input#p3').val()) && $('input#p3').val() >= 0){
            startMark.push(Number($('input#p3').val()));
        }
        else{
            startMark.push(0);
        }if(Number($('input#p4').val()) && $('input#p4').val() >= 0){
            startMark.push(Number($('input#p4').val()));
        }
        else{
            startMark.push(0);
        }if(Number($('input#p5').val()) && $('input#p5').val() >= 0){
            startMark.push(Number($('input#p5').val()));
        }
        else{
            startMark.push(0);
        }
        //IN SVG
        console.log(startMark);
        genTree(startMark);
        return;
    }
//    render_tree("data.json");
</script>
</html>